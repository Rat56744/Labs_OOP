Ред. Кудреватых Павел, ПМ-31

## Лекция 9+10

Тема: Уравнение теплопроводности. Метод Даламбера и Фурье. Интерпретация результатов. Функция Грина.

> В лекции многие формулы и тезисы повторяются и должны восприниматься проще. Данная тема разобрана в соответствующей главе учебника (см. глава 6 на стр.118) более подробно.

Классический вид уравнения теплопроводности:
$$
U_t -a^2 U_{xx}=f(x,t); \\
\begin{cases}
U(x,0) = \varphi(x), \ 0 \leq x \leq l; \\
U(0,t) = \mu(t),\ 0 \leq t \leq T;\\
U(l,t) = \nu(t).
\end{cases}
$$


### Решение методом Фурье

> Обратите внимание, что данное решение уже было рассмотрено при обсуждении метода разделения переменных, поэтому приведем краткий конспект для закрепления материала.

Для начала разобьем исходную задачу на три подзадачи методом редукции КЗ:
$$
\begin{matrix}
  U_t -a^2 U_{xx}=0;
  &
  U_t -a^2 U_{xx}=f(x,t);
  &
  U_t -a^2 U_{xx}=0;
  
  \\
  
  \begin{cases}
    U(x,0) = \varphi(x); \\
    U(0,t) = 0; \\
    U(l,t) = 0;
  \end{cases} 
  
  &
  
  \begin{cases}
    U(x,0) = 0;\\
    U(0,t) = 0;\\
    U(l,t) = 0;
  \end{cases}
  
  &
  
  \begin{cases}
    U(x,0) = 0;\\
    U(0,t) = \mu(t);\\
    U(l,t) = \nu(t).
  \end{cases}
  
\end{matrix}
$$



#### **Задача 1**

1. Решение уравнения теплопроводности однородного уравнения методом Фурье приводится через разделение переменных:

$$
U_t = a^2 U_{xx},\\[2pt]
U(x,t) = X(x)T(t),\\[2pt]
T'X = a^2 X''T,\\[2pt]
\frac{1}{a^2}\frac{T'}{T} = \frac{X''}{X} = -\lambda^2.
$$

Разложим на два независимых уравнения:
$$
X'' = -\lambda^2 X,\\
T' = -(a\lambda)^2T.
$$
Решением первого уравнения будет комбинация синусов и косинусов, решением второго уравнения будет экспонента:
$$
X = A\sin(\lambda x) + B\cos(\lambda x),\\
T = Ce^{\displaystyle-a^2\lambda^2t}.
$$
Перемножая функции, получим:
$$
U(x,t) =\left(A'\sin(\lambda x) + B'\cos(\lambda x) \right)e^{\displaystyle-a^2\lambda^2t},\\
 A' = AC,\ B' = BC.
$$

2. Наложим ограничения по длине стержня. Пусть заданы граничные условия первого рода: 

$$
U(0,t) = B' e^{\displaystyle-a^2\lambda^2t} = 0 \implies B' = 0;
$$

$$
U(l,t) = \left(A'\sin(\lambda l)  \right)e^{\displaystyle-a^2\lambda^2t} = 0\implies \lambda_n l = \pi n,\ n\in \N,
\\
\lambda_n = \frac{\pi n}{l}.
$$

> Обратите внимание, что если бы были заданы условия второго рода, то сократился бы $\sin$, а не $\cos$. , Так как $\lambda>0$, поэтому $n \in \N$ вместо $n\in\Z$.



3. Добавим в решение начальные условия как линейную комбинацию функций, которые являются решением (синусов):

$$
U(x,0) = \varphi(x) =\sum A_n\sin\left(\frac{\pi n}{l} x\right),\\
A_n = \frac 2 l\int\limits_0^l \varphi(\xi)\sin\left(\frac{\pi n}{l} \xi\right)\, \mathrm{d}\xi.
$$

> На этом можно было бы закончить, но сделаем еще один шаг, который поможет нам на второй лекции. Английский математик Джордж Грин хотел записать решение в интегральном виде, поскольку именно такой вид позволял ему легко оперировать интегральными преобразованиями Фурье при решении ДУЧП. 
>
> Этот термин нам пока не знаком, но носит крайне важную функцию и поможет в будущем, так что запишем и запомним: **интегральные преобразования**.

Посмотрим, как Джордж Грин поменял суммирование и интеграл местами:

$$
U(x,t) = \sum \left[
\frac 2 l\int\limits_0^l \varphi(\xi)\sin\left(\frac{\pi n}{l} \xi\right)\, \mathrm{d}\xi
\right]
\sin\left(\frac{\pi n}{l} x\right) 
\times 
e^{\displaystyle-\left(\frac{\pi n a}{l}\right)^2t}.
$$
Итак, рассмотрим 3 части:

* Часть с $\xi$ вынести не можем, в тоже время знак суммы внесем под знака интеграла;
* Часть с экспонентой внесем под знак интеграла, так как $\xi$ в ее степени отсутствует;
* Части с $x$ так же внесем под знак интеграла.

$$
U(x,t) = \int\limits_0^l
\left[
\frac 2 l \sum
e^{\displaystyle-\left(\frac{\pi n a}{l}\right)^2t}
\sin\left(\frac{\pi n}{l} \xi\right)
\sin\left(\frac{\pi n}{l} x\right)
\right]
 \varphi(\xi)\, \mathrm{d}\xi.
$$

Обратим внимание, что выражение в квадратных скобках записано через параметры уравнения. Запишем этот множитель как отдельную функцию:
$$
U(x,t) = \int\limits_0^l G(x,\xi,t) \varphi(\xi)\, \mathrm{d}\xi.
$$
Сгруппируем немного иначе и визуально еще раз сверим полученную функцию с разложением в ряд Фурье:
$$
A_n = \int\limits_0^l \frac 2 l \sin\left(\frac{\pi n}{l}\xi\right)\varphi(\xi) \, \mathrm{d}\xi.
$$
Получилось разложение НУ по базисным функциям $G(x,\xi,t)$. Можно возразить, что в этих базисных функциях нет разных базисных функций, также в ряде присутствует индекс $n$.

Однако, как можно заметить, индекс остался внутри функции $G$, а изменяется она переменной $\xi$. 

> Повторим, так как это важно. У Фурье бесконечная сумма, у Грина тоже бесконечная сумма (Интеграл):
>
> * У Фурье сумма по разным $\lambda_n$ $\rightarrow$ **Разные функции приложены ко всей числовой прямой;**
> * У Грина Интеграл (предел суммы) по разным точкам прямой (по разным компонентам вектора) $\rightarrow$ **одна и та же функция последовательно прикладывается к разным точкам числовой прямой** $x = \xi$.



Чтобы узнать, что это за функция, мы могли бы взять обратное преобразование Фурье от того, что у нас получилось. К счастью, нам уже известен результат:
$$
G(x,\xi,t)=
\left[
\frac 2 l \sum
e^{\displaystyle-\left(\frac{\pi n a}{l}\right)^2t}
\sin\left(\frac{\pi n}{l} \xi\right)
\sin\left(\frac{\pi n}{l} x\right)
\right].
$$
> Функция была названа в честь Грина (функция Грина). Точнее перед нами ее образ. Как она выглядит на самом деле (не в виде бесконечной суммы), мы разберемся чуть позже.

### Задача 2

$$
U_t -a^2 U_{xx}=f(x,t); \\
\begin{cases}
U(x,0) = 0;\\
U(0,t) = 0;\\
U(l,t) = 0.
\end{cases}
$$

Зная, что мы ищем разложение в ряд синусов, сразу запишем вид нашего ответа:
$$
U(x,t) = \sum T_n \sin\left(\frac{\pi n}{l} x\right).
$$
Разложим в ряд функцию в правой части:
$$
f(x,t) = \sum F_n \sin\left(\frac{\pi n}{l} x\right),\\
F_n = \frac 2 l \int\limits_0^l 
f(\xi,t)
\sin\left(\frac{\pi n}{l} \xi\right) 
\, \mathrm{d}\xi.
$$
Подставим в исходное уравнение и сократим лишние синусы:
$$
\sum T'_n \sin\left(\frac{\pi n}{l} x\right) 
- a^2 \left(-\frac{\pi n}{l}\right) ^2
\sum T_n \sin\left(\frac{\pi n}{l} x\right)
=
\sum F_n \sin\left(\frac{\pi n}{l} x\right).
$$
После сокращения:
$$
T_n' +  \left(\frac{\pi a n}{l}\right)^2 T_n = F_n.
$$
Перед нами неоднородное ДУ по одной переменной.

> Далее опять не решаем обычное ДУ. Кто хочет восстановить в памяти порядок решения — обращаемся на консультациях. Главное помним, что нам нужна сумма общего и частного решения, поиск которого делается методом вариации постоянной при условии, что $T_n(0) = 0$.

Решение получается следующим:
$$
T_n = \int\limits_0^t 
\exp\left(-\left(\frac{\pi a n}{l} \right)^2 (t-\tau)\right)
F_n(\tau)\, \mathrm{d}\tau.
$$
Помним, что $F_n$ тоже интегральная проблема. Таким образом, получаем опять двойные интегралы. Это наталкивает на мысль, что неоднородные задачи лучше всего решать числено.

### Задача 3

$$
U_t -a^2 U_{xx}=0; \\
\begin{cases}
U(x,0) = 0;\\
U(0,t) = \mu(t);\\
U(l,t) = \nu(t).
\end{cases}
$$

Вспоминаем, как мы поступали в аналогичной ситуации с уравнением колебания струны, и вводим новые переменные:
$$
W(x,t) = \mu(t) + \frac x l (\nu(t) -\mu(t));
$$

$$
U = W + V.
$$

Система уравнений примет вид:
$$
V_t = a^2 V_{xx} + \tilde{f}(x,t);\\
\begin{cases}
V(0,t) = 0;\\
V(l,t) = 0;\\
V(x,0) = \tilde\varphi(x),
\end{cases}
$$
где новые функции:
$$
\tilde f (x,t) = -W_t + A^2 W_{xx} = -\mu'(t) - \frac x l (\nu'(t)-\mu'(t));
\\
\tilde \varphi (x) = -\mu(0) - \frac x l (\nu(0)-\mu(0)).
$$


Система раскладывается на уже привычные нам задачи 3.1. и 3.2. по принципу редукции КЗ:
$$
\begin{matrix}

V_t = a^2 V_{xx};
&
V_t = a^2 V_{xx} + \tilde{f}(x,t);

\\

\begin{cases}
V(0,t) = 0;\\
V(l,t) = 0;\\
V(x,0) = \tilde\varphi(x);
\end{cases}
&
\begin{cases}
V(0,t) = 0;\\
V(l,t) = 0;\\
V(x,0) = 0.
\end{cases}

\end{matrix}
$$


#### Суммарное решение и его интерпретация

Решением произвольной КЗ будет сумма решений Задачи 1 + Задачи 2 + Задачи 3.

* Задача 1 задает классическую картину того, как на однородных условиях тепло постепенно утекает через границы стержня, вся функция стремится к нулю. Это решение описывает медленно спадающие начальные условия. Фурье обнаружил, что очень удобно спадают именно функции типа синусов или косинусов.
* Задача 2 задает распределение тепла в стержне при условии его нагрева. Решение этой задачи — стационарное распределение на $t \to \infty$ .
* Задача 3 задает решение распределения тепла при его контроле на концах стержня (что, в принципе, можно представить как постоянное движение стержня в пространстве, в котором есть градиент температуры, например, перенос стержня из холодильника на плиту). Задача 3 разбивается на подзадачи:
  * Задача 3.1. задает распределение тепла при условии наличия "внешних сил" — фиктивных точек нагрева, вызванных перемещением стержня;
  * Задача 3.2. задает распределение тепла при условии ненулевого "начального распределения" — фиктивной функции, которая в начальный момент времени отклоняет температуру стержня от линейного тренда, от горячего конца к холодному.



#### Граничные условия

* ГУ первого рода описывают постоянную температуру — бесконечно быстрый поток температуры (по крайней мере, относительно нашего стержня). Например, нить накаливания в лампе можно задать при помощи ГУ первого рода — концы спирали все время будут холодными на достаточно большом расстоянии, при этом центр будет светиться в видимой части спектра;
* ГУ второго рода описывают нулевой поток тепла или теплоизоляцию. Стенки термоса будут ГУ второго рода, они выпускают и впускают количество тепла пренебрежимо малое по сравнению с теплом системы. Однако чем меньше тепла в системе, тем "идеальнее" нужен термос.



(На этом заканчивается первая лекция)

_________________________________





### Метод Даламбера и функция Грина

>  Метод Даламбера в этот раз гораздо сложнее, чем мог бы показаться, поэтому его вывод не приводится.

**Метод Даламбера сводится к базису не синусов, а дельта функций**. Вспомните аналогию с векторами и трехмерным пространством $\{\vec{i}, \vec{j}, \vec{k} \}$.

Иными словами, вместо того, чтобы представить НУ $U(x,0) = \varphi(x)$ в виде суммы синусов $\varphi(x) = \sum A_n \sin(\lambda x) + B_n \cos(\lambda x)$, мы представляем ее как сумму дельта функций Дирака (вспомините обобщенные функции). 
$$
\begin{matrix}
{
\varphi(x) = 
\begin{cases}
A_1\sin(\lambda_1 x),\\
A_2\sin(\lambda_2 x),\\
A_3\sin(\lambda_3 x),\\
...\\
A_n\sin(\lambda_n x),\\
...
\end{cases}
}
&;
{
\ \varphi(x) = 
\begin{cases}
[A'_1,0,0,0,0,0,...]\\
[0,A'_2,0,0,0,0,...]\\
[0,0,A'_3,0,0,0,...]\\
...\\
[..., 0,0,0,0,0,A'_n]\\

\end{cases}
=
\sum A'_i\delta(x-x_i).
}
\end{matrix}
$$

Более того, мы можем представить все решение как сумму дельта-функций Дирака, каждая из которых умножается на какую-то функцию по времени:
$$
U = \sum A_i \delta(x-x_i)T_i(t).
$$
Несложно предположить, что если у нас есть линейная задача (линейный дифференциальный оператор), то в пространстве векторов мы можем записать факт того, что наше решение должно давать:
$$
U_t -a^2 U_{xx}=0; 
\\
\Phi(*) =\frac {\delta }{\delta t}  - a^2\frac {\delta^2 }{\delta x^2}.
$$
Допустим, что мы хотим найти такое решение, которое бы описывало поведение нашей системы на внешнюю силу в виде одной дельта функции. Если это так, значит, пользуясь законом линейности, мы можем представить любую внешнюю силу в виде суммы базисных векторов. Получим, что наше решение будет линейной комбинацией решений. 
$$
\Phi(U) =\Phi\left[ \sum A_i \delta(x-x_i)T_i(t))\right] =

\sum\Phi\left[  A_i \delta(x-x_i)T_i(t))\right]  = 
\sum\Phi_i
$$


Второй важный вывод заключается в том, что, поскольку стержень идентичен, для него нет разницы между $x_i$ и $x_j$ — решение должно выглядеть одинаково.

Это значит:
$$
\Phi (U_i) = \delta(x-x_i);\\
U_i = \Phi^{-1}(\delta_i).\\
T_i = T, \text{не зависит от i}
$$
Осталось понять, как найти обратный оператор к нашему дифференциальному оператору. Если бы мы нашли такую функцию, то могли бы сказать, что:

$$
f(x,t) = \sum f_i \delta_i;\\

\Phi U = f(x,t).
$$


Значит решение:
$$
U = \sum\limits_i U_i.
$$
Перепишем в интегральном виде:
$$
f(x,t) = \int f(\xi,t) \delta(x-\xi)\, \mathrm{d}\xi.
$$
Это функция "взятия значения". Результатом интеграла будет значение функции в точке:
$$
U_i \implies G(x,\xi,t);
$$

$$
U = \int
G(x,\xi,t)\delta(\xi)
\, \mathrm{d}\xi.
$$



### Другой взгляд на функцию Грина — отклик системы

Как же найти такую функцию? К сожалению, обратный оператор найти сложно, так что в каждом конкретном случае нам придется, не опираясь на общий алгоритм, пытаться найти функцию:

$$
\Phi(G(x,\xi,t)) = \delta(x-\xi).
$$
Например, для нашего ДУ надо решить
$$
G_t -a^2 G_{xx} = \delta(x-\xi)
$$
Противоречит Фурье ($U(x,t) = T(t) \cdot X(x)$)

при нулевых начальных и граничных условиях. Как видим, здесь есть свободная переменная, не очень удобная для поиска общего решения.

**Выше мы уже показали**, как, зайдя с другой стороны, можно было бы найти такую функцию через разложение Фурье, но Джордж Грин пошел чуть дальше. Он нашел такую функцию (частично методом подбора (см. лекцию о трудностях решения дифференциальных уравнений в общем виде)):
$$
G(x,\xi,t) = \frac{1}{2a\sqrt{\pi t}} e^{\displaystyle-\frac{(\xi-x)^2}{4a^2t}}.
$$
**Теперь любая задача теплопроводности автоматически решена в общем виде.**



### Как решить любую* задачу функцией Грина

1. Внешние силы. Решение следует из определения: функция Грина есть не что иное, как отклик на точечные воздействия (точечные добавления тепла — моментально). Обратите внимание, что если тепло добавляется постепенно, то в каждый следующий момент как будто добавляется новая функция Грина поверх старой (см. формулу 1).
2. Ненулевые НУ. Пусть в момент времени $t=0$ во все точки стержня сообщили соответствующее значение тепла мгновенно, так чтобы получилась функция $U(x,0) = \varphi(x)$. Задача сводится к изначальной. Такое разложение запишем формулой 2.
3. Ненулевые ГУ. Функция Грина неприменима. 

> Точнее функция Грина применима, но этот случай выходит за рамки нашего изучения, так что мы о нем просто умолчим. Для нас функция Грина применима только на бесконечном стержне.
>

Задача 1:
$$
U_t = a^2 U_{xx} + f(x,t);\\
U(x,0) = 0.
$$


Формула 1:
$$
U(x,t) = \int\limits_0^t \int\limits_{-\infty}^{\infty}
G(x,\xi,t-\tau)f(\xi,\tau)
\, \mathrm{d}\xi \, \mathrm{d}\tau.
$$
Задача 2:
$$
U_t = a^2 U_{xx}; \\
U(x,0) = \varphi(x).
$$


Формула 2:
$$
U = \int\limits_{-\infty}^{\infty}
G(x,\xi,t)\varphi(\xi)
\, \mathrm{d}\xi
=
 \int\limits_{-\infty}^{\infty}
\frac{1}{2a\sqrt{\pi t}} e^{\displaystyle-\frac{(\xi-x)^2}{4a^2t}}
\varphi(\xi)
\, \mathrm{d}\xi.
$$






___________________________



#### Шпаргалка для теплопроводности

**2. Уравнение теплопроводности(Параболический тип)**

​		2.1.	Метод Даламбера (без граничных условий, на бесконечном стержне).
$$
u(t,x) = \frac{1}{(2a\sqrt{\pi t})^m}\int\limits_{R^m} u_0(\xi) e^{\displaystyle{-\frac{|x-\xi|^2}{4a^2t}}}\, \mathrm{d}\xi + \int\limits_0^t\int\limits_{R^m} \frac{f(\tau,\xi)}{[2a\sqrt{\pi(t-\tau)}]^m} e^{\displaystyle{-\frac{|x-\xi|^2}{4a^2(t-\tau)}}}\, \mathrm{d}\xi\,\mathrm{d}\tau.
$$
​		2.2.	Метод Фурье (Метод Штурма — Леувилля) (если нет внешних условий).

*  	Решение однородного с НУ (оставляем с суммой):
$$
u(x,t) = \sum\limits_{n=1}^\infin C_n e^{\displaystyle{-\left(\frac{\pi an}{l}\right)^2t}} \sin\frac{\pi n}{l}x = \sum\limits_{n=1}^\infin \left[\frac{2}{l} \int\limits_0^l \varphi(\xi) \sin\frac{\pi n}{l}\xi \,\mathrm{d}\xi\right] e^{\displaystyle{-\left(\frac{\pi an}{l}\right)^2t}} \sin\frac{\pi n}{l}x = \\
= \int\limits_0^l \left[\frac{2}{l} \sum\limits_{n=1}^\infin e^{\displaystyle{-\left(\frac{\pi an}{l}\right)^2t}} \sin\frac{\pi n}{l}x \sin\frac{\pi n}{l}\xi \right] \varphi(\xi)\, \mathrm{d}\xi.
$$
* 			Решение неоднородного без НУ (оставляем с суммой):
$$
u(x,t) = \int\limits_0^t\int\limits_0^l \left[\frac{2}{l} \sum\limits_{n=1}^\infin e^{\displaystyle{-\left(\frac{\pi an}{l}\right)(t-\tau)}} \sin\frac{\pi n}{l}x \sin\frac{\pi n}{l}\xi \right] f(\xi,\tau)\, \mathrm{d}\xi\, \mathrm{d}\tau.
$$
​		2.3.	Метод Фурье (Метод Штурма — Леувилля) (если есть внешние условия).

​    Сводим к уже решенной путем замены:
$$
\begin{matrix}
	u_t = a^2u_{xx},\ 0<x<l,\ t>0;
	&
	v_t = a^2v_{xx} + \tilde{f}(x,t),\ 0<x<l,\ t>0;
	
	\\
	
	\begin{matrix}
        \begin{cases}
            u(0,t) = \mu(t);\\
            u(l,t) = v(t),
        \end{cases}
        &
        t \geq 0;\\
        u(x,0) = 0,\ 0 \leq x \leq l,
    \end{matrix}
    &
    \begin{matrix}
        \begin{cases}
            v(0,t) = 0;\\
            v(l,t) = 0,
        \end{cases}
        &
        t \geq 0;\\
        v(x,0) = \tilde{\varphi}(x),\ 0 \leq x \leq l.
    \end{matrix}
\end{matrix}
$$

$$
u(x,t) = v(x,t) + w(x,t),\\
\tilde{f}(x,t) = - w_t = a^2w_{xx} = -\mu'(t) - \frac{x}{l}[v'(t) - \mu'(t)],\\
\tilde{\varphi}(x) = -w(x,0) = -\mu(0) - \frac{x}{l}[v(0) - \mu(0)].
$$

​		2.3.	Метод Грина (неоднородное с НУ).
$$
u(x,t) = \int\limits_{-\infin}^\infin G(x,\xi,t) \varphi(\xi)\, \mathrm{d}\xi + \int\limits_0^t \int\limits_{-\infin}^\infin G(x,\xi,t-\tau)f(\xi,\tau)\, \mathrm{d}\xi\, \mathrm{d}\tau =\\
= \frac{1}{2a\sqrt{\pi t}} \int\limits_{-\infin}^\infin e^{\displaystyle{-\frac{(\xi-x)^2}{4a^2t}}} \varphi(\xi)\, \mathrm{d}\xi + \frac{1}{2a\sqrt\pi} \int\limits_0^t \int\limits_{-\infin}^\infin \frac{1}{\sqrt{(t-\tau)}} e^{\displaystyle{-\frac{(\xi-x)^2}{4a^2(t-\tau)}}} f(\xi,\tau)\, \mathrm{d}\xi\, \mathrm{d}\tau.
$$
​		2.5.	Неоднородное с ненулевыми ГУ — численно.

#### Шпаргалка для уравнений колебаний.

**1. Уравнение неограниченной струны (Гиперболический тип)**

   1.1.	Уравнение неограниченной струны $\rightarrow$ Метод Даламбера.

$$
u(t,x) = \frac{1}{2}[u_0(x + at) + u_0(x-at)] + \frac{1}{2a} \int\limits_{x-at}^{x+at} u_1(\xi)\, \mathrm{d}\xi + \frac{1}{2a} \int\limits_0^t \int\limits_{x-a(t-\tau)}^{x+a(t-\tau)} f(\tau,\xi)\, \mathrm{d}\xi\, \mathrm{d}\tau.
$$

​		1.2.	Ограниченная струна $\rightarrow$ Метод Даламбера, Продолжений.
$$
u(x,t) = \frac{\Phi(x+ct) + \Phi(x-ct)}{2} + \frac{1}{2c} \int\limits_{x - ct}^{x + ct} \Psi(s)\, \mathrm{d}s,\\
\Phi(x) = \Phi(-x),\ \Phi(x) = \Phi(2l - x),\\
\Psi(x) = \Psi(-x), \Psi(x) = \Psi(2l - x).
$$
​		1.3.	Метод Фурье (Нулевые ГУ).
$$
u(x,t) = \sum\limits_{n=1}^\infin u_n(x,t) = \sum\limits_{n=1}^\infin \left(A_n\cos\frac{\pi cn}{l}t + B_n\sin\frac{\pi cn}{l}t \right)\sin\frac{\pi n}{l}x,\\
A_n = \Phi_n = \frac{2}{l} \int\limits_0^t \varphi(x) \sin\frac{\pi n}{l}x\, \mathrm{d}x,\\
B_n = \frac{l}{\pi cn}\Psi_n = \frac{2}{\pi cn} \int\limits_0^t\uppsi(x) \sin\frac{\pi n}{l}x\, \mathrm{d}x.
$$
​		1.4.	Метод Штурма — Леувилля ($T(t) \cdot X(x)$) (смешанные ГУ).

![image-20201102214326385](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%209%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%209.assets/image-20201102214326385.png)

​		1.5.	Ненулевые ГУ — численно.





































## Семинар 9+10

Тема: Решение КЗ по уравнениям колебаний струны.  (Даламбер + Фурье)

_________________



#### Пример 1: Метод Даламбера 1

$$
U_{tt} = U_{xx} + 6;\\
U(x,0) = x^2;\\
U_t(x,0) = 4x.\\
$$

Обратим внимание на полное отсутствие ГУ. Без ГУ — с неограниченным $x$ — функция уходит в бесконечность. К счастью, перед нами **приближение**, то есть на каком-то маленьком фрагменте струна изогнулась "очень интересным" образом.

**Важно.** Для задач в "приближениях" для того, чтобы избавиться от проблем, надо ограничить зону интереса.

**Допустим, несмотря на отсутствие ГУ, нас интересует фрагмент струны от 0 до L**.

> На контрольной и экзамене это, своего рода, "флажочек", обозначающий, что пример надо решать именно по Даламберу, так как решение явно будет иметь несложный вид. Однако, по методу Фурье такое тоже можно решить.

Все дальнейшие выкладки приведены именно для такого случая. 

Итак, запишем решение Даламбера (помним, что $U(x,0) = \varphi(x)$, а $U_t(x,0) = \psi(x)$):
$$
U = \frac{\varphi(x+ct)+\varphi(x-ct)}{2} + \frac{1}{2c}\int\limits_{x-ct}^{x+ct}\psi(\xi)\, \mathrm{d}\xi
+ \frac{1}{2c}\int\limits_0^t
\int\limits_{x-c(t-\tau)}^{x+c(t-\tau)}f(\tau,\xi)\, \mathrm{d}\xi \, \mathrm{d}\tau.
$$
Запишем наши параметры:
$$
c = 1,\\
\varphi(x) = x^2,\\
\psi(x) = 4x,\\
f(x,t)= 6.
$$
Подставим в интеграл:
$$
U = \frac{(x+t)^2 + (x-t)^2}{2} + \frac 1 2 \int\limits_{x-t}^{x+t} 4\xi \, \mathrm{d}\xi +
\frac 1 2 \int\limits_0^t
\int\limits_{x-t+\tau}^{x+t-\tau}6 \, \mathrm{d}\xi \, \mathrm{d}\tau.
$$
Упрощаем:


$$
U = x^2 + t^2 + (x+t)^2 - (x-t)^2 + \frac 6 2 \int\limits_0^t 2(t-\tau) \, \mathrm{d}(t-\tau);
$$

$$
U = x^2 + t^2 -4xt + 3t^2 = x^2 - 4xt + 4t^2.
$$

##### Ответ:

$$
U = (x-2t)^2.
$$



#### Пример 2: Метод Даламбера 2

$$
U_{tt} = 9U_{xx} + \sin(x);\\
U(x,0) = 1;\\
U_t(x,0) = 1.
$$



Формула Даламбера:
$$
U = \frac{\varphi(x+ct)+\varphi(x-ct)}{2} + \frac{1}{2c}\int\limits_{x-ct}^{x+ct}\psi(\xi)\, \mathrm{d}\xi
+ \frac{1}{2c}\int\limits_0^t
\int\limits_{x-c(t-\tau)}^{x+c(t-\tau)}f(\tau,\xi)\, \mathrm{d}\xi \, \mathrm{d}\tau.
$$
Дано:
$$
c = 3,\\
\varphi(x) = 1,\\
\psi(x) = 1,\\
f(x,t)= \sin(x).
$$
Подставляем в формулу и получаем:
$$
U = \frac{1+1}{2} + \frac{1}{6}\int\limits_{x-3t}^{x+3t}d\xi
+ \frac{1}{6}\int\limits_0^t
\int\limits_{x-3(t-\tau)}^{x+3(t-\tau)}\sin(\xi)\, \mathrm{d}\xi \, \mathrm{d}\tau.
$$
Возьмем полученной выражение по частям:
$$
U = 1 + t - \frac{1}{6}\int\limits_0^t
(\cos(x+3t-3\tau)-\cos(x-3t+3\tau)) \, \mathrm{d}\tau.
$$
Разобьем на два интеграла и внесем под знак дифференциала то, что необходимо:
$$
U = 1+t - \frac 1 6(I_1 - I_2),
$$
где
$$
I_1 = \int\limits_0^t \cos(x+3t-3\tau) \, \mathrm{d}\tau =- \frac 1 3 \int\limits_0^t \cos(x+3t-3\tau) \, \mathrm{d}(x+3t-3\tau),
$$

$$
I_1 = \frac 1 3 \sin(x+3t) - \frac 1 3 \sin(x),
$$

$$
I_2 = \int\limits_0^t \cos(x+3t+3\tau) \, \mathrm{d}\tau = \frac 1 3 \int\limits_0^t \cos(x+3t+3\tau) \, \mathrm{d}(x+3t+3\tau),
$$

$$
I_2 = \frac 1 3 \sin(x+6t) - \frac 1 3 \sin(x+3t).
$$

Соединим воедино:
$$
U = 1+t - \frac 1 {18}( \sin(x+3t) -  \sin(x) - \sin(x+6t) + \sin(x+3t)).
$$

##### Ответ:

$$
U = 1+t - \frac 1 {18}( 2\sin(x+3t) -  \sin(x) - \sin(x+6t)).
$$



Важно: если не заданы ГУ, мы можем почти идеально укладывать любые функции и графики в наше решение. Из-за простоты подхода и результата решение Даламбера популярно до сих пор. 

#### Пример 3: Метод Фурье 1

$$
U_{tt} = a^2 U_{xx};\\
\begin{cases}
U(0,t) = 0;\\
U_x(l,t) = 0;\\
U(0,x) = \sin\left(\dfrac{\pi x}{2l} \right);\\[3pt]
U_t(0,x) = \sin\left(\dfrac{3\pi x}{2l} \right).\\
\end{cases}
$$

Перед нами однородное ДУ с однородными ГУ, так что можно сразу переходить к решению. Посмотрев в "шпаргалку" (или в предыдущую лекцию), выписываем общий вид решения:

$$
U = \sum\limits_n
\left(
A_n \cos \left(\frac{\pi a (2n-1)}{2l}t\right) + 
B_n \sin \left(\frac{\pi a (2n-1)}{2l}t\right)
\right)
\sin \left(\frac{\pi (2n-1)}{2l}x\right).
$$
Обратите внимание, что по $X$ у нас не совсем синус, а нечетное количество полуволн. При этом значения $A_n$ и $B_n$ осталось вычислить по формулам из учебника:

$$
A_n = \frac 2 l \int\limits_0^l
\sin(\frac{\pi}{2 l}x) 
\sin \left(\frac{\pi (2n-1)}{2l}x\right)
\, \mathrm{d}x.
$$
Заметим, что перед нами интеграл (скалярное произведение) двух базисных векторов: $e_1 (n = 1)$ и $e_n$. Как известно из свойств таких функций, ненулевой результат (результат равный единице) может получиться, если наши базисные функции совпадают. Иными словами:
$$
\forall n \neq 1:  A_n = 0,
$$

$$
A_1 = 1.
$$

Второй случай:
$$
B_n =  \frac 2 l \frac{2l}{\pi a (2n-1)}\int\limits_0^l
\sin(\frac{3\pi}{ 2l}x) 
\sin \left(\frac{\pi (2n-1)}{2l}x\right)
\, \mathrm{d}x.
$$
Выше приведен аналогичный случай с дополнительным множителем:
$$
\forall n\neq2:  B_n = 0,
$$

$$
B_2 = \frac{2l}{3\pi a}.
$$

В итоге, можем записать ответ.

##### Ответ:

$$
U = \cos \left(\frac{\pi a t}{2l} \right)\sin\left(\frac{\pi x}{2l}\right)
+
 \frac{2l}{3\pi a}
\sin \left(\frac{3\pi a t}{2l} \right)\sin\left(\frac{3 \pi x}{2l}\right).
$$





_____________



#### Пример 4: Метод Фурье 2

$$
U_{tt} = 9U_{xx} -4U; \\
\begin{cases}
U(0,t) = 0;\\
U(l,t) = 0;\\
U(0,x) = x^2-x;\\
U_t(0,x) = 0;\\
l = 1.
\end{cases}
$$



Разбиваем на две подзадачи:
$$
\begin{matrix}

U_{tt} = 9U_{xx} -4U; 
&
U_{tt} = 9U_{xx};

\\

\begin{cases}
U(0,t) = 0;\\
U(l,t) = 0;\\
U(0,x) = 0;\\
U_t(0,x) = 0;\\
\end{cases}

&

\begin{cases}
U(0,t) = 0;\\
U(l,t) = 0;\\
U(0,x) = x^2-x;\\
U_t(0,x) = 0.\\
\end{cases}

\end{matrix}
$$

##### Подзадача 1

$$
U_{tt} = 9U_{xx}; \\
\begin{cases}
U(0,t) = 0;\\
U(l,t) = 0;\\
U(0,x) = x^2-x;\\
U_t(0,x) = 0.\\
\end{cases}
$$

Обратим внимание, что следует вначале решать однородное уравнение. Это позволит нам сразу узнать вид общего решения, чтобы было проще искать частное решение в подзадаче 2.

Решаем методом Фурье. На этот раз пройдем весь путь от замены и до ответа, не будем пользоваться готовой формулой:
$$
U (x,t) = T(t)X(x).
$$

$$
T''X = 9X''T;\\
T'' = -9\lambda^2T;\\
X'' = -\lambda^2 X.
$$

Сначала пойдем вдоль X и найдем базисные функции и базисные длины волн:
$$
X = \sum \limits_n(A_n \sin(\lambda_n x)+ B_n \cos(\lambda_n x)).
$$

$$
X(0) = 0 \implies B_n = 0;\\
X'(l) = 0 \implies \lambda_n l = \pi n;\\
\lambda_n = \frac{\pi n}{l}.
$$

$$
X = \sum \limits_n\left(A_n \sin(\frac{\pi n}{l} x)\right).
$$

Найдем выражение для T:
$$
T_n'' = -\left(\frac{3\pi n}{l} \right)T_n,
$$
или
$$
T = \sum \limits_n C_n \cos\left( \frac{3 \pi n }{l} t\right) + D_n \sin\left( \frac{3 \pi n }{l} t\right).
$$
Отсюда можно сразу вывести ответ:
$$
U(x,t) = \sum\limits_n 
\left(
C_n \cos\left( \frac{3 \pi n }{l} t\right) + D_n \sin\left( \frac{3 \pi n }{l} t\right)
\right)
A_n \sin(\frac{\pi n}{l} x).
$$
Переобозначим константы:
$$
U(x,t) = \sum\limits_n 
\left(
A_n \cos\left( \frac{3 \pi n }{l} t\right) + B_n \sin\left( \frac{3 \pi n }{l} t\right)
\right)
\sin(\frac{\pi n}{l} x).
$$
Упростим, используя равенство нулю первой производной:
$$
U_t(x,0) = \sum\limits_n 
\left(
-A_n \sin\left( 0\right) + B_n \cos\left( 0\right)
\right)
\sin(\frac{\pi n}{l} x) = 0;
$$

$$
\sum\limits_n 

 B_n 

\sin(\frac{\pi n}{l} x) = 0 \implies B_n = 0,
$$



или, после упрощения:
$$
U(x,t) = \sum\limits_n 

A_n \cos\left( \frac{3 \pi n }{l} t\right) 

\sin(\frac{\pi n}{l} x).
$$


Применим другое НУ (последнее):
$$
U(x,0)  = \sum\limits_n 

A_n 

\sin(\frac{\pi n}{l} x) = x^2-x.
$$
Найдем разложение нашей функции по ряду синусов:
$$
A_n = \frac 2 l \int\limits_0^l (x^2-x) \sin(\frac{\pi n}{l} x)\, \mathrm{d}x.
$$
Данный интеграл берется по частям два раза:
$$
I_1 = \int\limits_0^l x^2\sin(\frac{\pi n x}{l}) \, \mathrm{d}x = \\=
\left[
2\left(\frac{l}{\pi n} \right)^3 \cos\left(\frac{\pi n x}{l}\right)
+
2x\left(\frac{l}{\pi n} \right)^2 \sin\left(\frac{\pi n x}{l}\right)
-
x^2\left(\frac{l}{\pi n} \right) \cos\left(\frac{\pi n x}{l}\right)
\right]
_0^l;
$$

$$
I_1 = 
\left[
2\left(\frac{l}{\pi n} \right)^3 (-1)^n

-
\frac{l^3}{\pi n} (-1)^n
\right] 
- 
\left[
2\left(\frac{l}{\pi n} \right)^3 


\right];
$$

второй интеграл:
$$
I_2 = \int\limits_0^l x\sin(\frac{\pi n x}{l}) \, \mathrm{d}x = \\=
\left[
\left(\frac{l}{\pi n} \right)^2 \sin(\frac{\pi n x}{l})
-
\left(\frac{l}{\pi n} \right)
x\cos(\frac{\pi n x}{l})


\right]_0^l = \\
= \left[
-
\frac{l^2}{\pi n}
(-1)^n


\right].
$$


Выразим $A_n$:
$$
A_n = \frac 2 l (I_1 - I_2) = \left[
4\frac{l^2}{\pi^3 n^3}  (-1)^n

-
2\frac{l^2}{\pi n} (-1)^n
\right] 
- 
\left[
4\frac{l^2}{\pi^3 n^3} 


\right]
+
\left[

2\frac{l}{\pi n}
(-1)^n


\right].
$$


На этом решение подзадачи закончено ($A_n $, строго говоря, можно оставить в интегральной форме).



##### Подзадача 2

$$
U_{tt} = 9U_{xx} -4U; \\
\begin{cases}
    U(0,t) = 0;\\
    U(l,t) = 0;\\
    U(0,x) = 0;\\
    U_t(0,x) = 0.\\
\end{cases}
$$

Перед нами стандартная задача по движению тела в поле внешних сил. Искать решение будем в виде:
$$
U = \sum T_n \sin(\frac{\pi n x}{l}).
$$
Подставим в уравнение и получим:
$$
T_n''\sin(\frac{\pi n x}{l}) = -9\frac{\pi^2n^2}{l^2} T_n \sin(\frac{\pi n x}{l})  -  4 T_n \sin(\frac{\pi n x}{l}).
$$
После деления приходим к обычному ДУ:
$$
T_n'' = -\left(\left(\frac{3\pi n}{l}\right)^2 - 4\right)T_n = -\beta_n^2 T_n.
$$
Решение данного уравнения достаточно простое (сила зависит от самой функции, поэтому можно вынести общий множитель). Убедитесь в том, что $\beta >0$. В данном случае это легко оценить "на глаз":
$$
T_n = \sum C_n \sin(\beta_nt) + D_n\cos (\beta_nt).
$$
Приложим НУ:
$$
T(0) = 0;\\
T_n(0) = \sum C_n \sin(0) + D_n\cos (0) = \sum D_n = 0 \implies D_n = 0.
$$
Аналогично для производной:
$$
T'(0) = 0;\\
T_n'(0) = \sum C_n \cos(0) - D_n\sin (0) = \sum C_n = 0 \implies C_n = 0.
$$
Получилось, что **существует только тривиальное решение данной задачи**.

> Вопрос на внимательность: почему из $\sum D_n = 0$ следует что $D_n = 0$? Вдруг там $\pm 1$? 
>
> Подсказка: обратите внимание, как именно выглядит НУ и куда именно был подставлен ноль в примере выше. Что не записано, но стоило бы, строго формально? 



##### Ответ:

$$
U  = \sum\limits_n 

A_n \cos\left( \frac{3 \pi n }{l} t\right) 

\sin(\frac{\pi n}{l} x),
$$

где:
$$
A_n =  \left[
4\frac{l^2}{\pi^3 n^3}  (-1)^n

-
2\frac{l^2}{\pi n} (-1)^n
\right] 
- 
\left[
4\frac{l^2}{\pi^3 n^3} 


\right]
+
\left[

2\frac{l}{\pi n}
(-1)^n


\right].
$$

_______





Для домашнего изучения:

$$
\newcommand{\sh}{\mathop{\rm sh}\nolimits}
\begin{align}
	\textbf{4.9.} \quad & u_{tt} = a^2u_{xx} + b \cdot \sh x ,\ 0<x<l,\ b = \mathrm{const},
	\\
	& u(t,0) = u(t,l) = u(0,x) = u_t(0,x) = 0.
	\\
	\textbf{4.10.} \quad & u_{tt} = u_{xx} + x(x - l)t^2,\ 0<x<l,\ t>0,\\
	& u(t,0) = u(t,l) = u(0,x) = u_t(0,x) = 0.
	\\
	\textbf{4.11.} \quad & u_{tt} = u_{xx},\ 0<x<\pi,\ t>0,\\
    & u(t,0) = t^2,\ u(t,\pi) = t^3,\ u(0,x) = \sin x,\ u_t(0,x) = 0.
    \\
    \textbf{4.12.} \quad & u_{tt} = u_{xx},\ 0<x<\pi,\ t>0,\\
    & u(t,0) = t,\ u_x(t,\pi) = 1,\ u(0,x) = \sin \frac{x}{2}, \ u_t(0,x) = 1.
    \\
    \textbf{4.13.} \quad & u_{xx} = u_{tt},\ 0<x<l,\ t>0,\\
    & u|_{x=0} = 0,\ u|_{x=l} = t,\ u|_{t=0} = u_t|_{t=0} = 0.
\end{align}
$$

$$
\begin{align}
	\textbf{6.9.} \quad & u_{tt} = u_{xx} + e^x;\ u|_{t=0} = \sin x,\ 
	u_t|_{t=0} = x + \cos x.
	\\
	\textbf{6.10.} \quad & u_{tt} = 9u_{xx} + \sin x;\ u|_{t=0} = 1, u_t|_{t=0} = 1.
	\\
	\textbf{6.11.} \quad & u_{tt} = a^2u_{xx} + \sin \omega x;\ u|_{t=0} = 0,\ 
	u_t|_{t=0} = 0.
	\\
	\textbf{6.12.} \quad & u_{tt} = a^2u_{xx} + \sin \omega t;\ u|_{t=0} = 0,\ 
	u_t|_{t=0} = 0.
\end{align}
$$

$$
\begin{align}
	\textbf{4.1.} \quad & u(t,0) = u(t,l) = 0,\ u(0,x) = 0,\ 
	u_t(0,x) = \sin \frac{2\pi x}{l}.
	\\
	\textbf{4.2.} \quad & u(t,0) = u(t,l) = 0,\ u(0,x) = \varphi(x), u_t(0,x) = \psi(x).
  	\\
  	\textbf{4.3.} \quad & u(t,0) = u_x(t,l) = 0,\ u(0,x) = \sin \frac{5\pi x}{2l},\ 
  	u_t(0,x) = \sin \frac{\pi x}{2l}.
  	\\
  	\textbf{4.4.} \quad & u(t,0) = u_x(t,l) = 0,\ u(0,x) = x,\ 
  	u_t(0,x) = \sin \frac{\pi x}{2l} + \sin \frac{3\pi x}{2l}.
\end{align}
$$





$$
u_t(t,x) = a^2u_{xx}(t,x),\ \frac{\partial u}{\partial x}(0,t) = 0,\ \frac{\partial u}{\partial x}(l,t) = 0.
\\
u(x,0) = \sin^2 \frac{5\pi x}{l}.
$$


$$
\lambda_n = \left(\frac{\pi n}{l}\right)^2, \ n \in \mathbb{N}\ \cup\ \{0\},\ 
X_n(x) = \cos \frac{\pi n}{l}x.
$$


$$
U(x,0) = \frac 1 2 - \frac 1 2\cos(\frac{10 \pi x}{l})\\
X_n = \cos (\frac{\pi n x}{l})
$$

$$
B_n = 0\\
A_{10} \ne 0\\
n \ne 10 : A_n = 0
$$

$$
\int \sin^2(ax) \cos(bx)\, \mathrm{d}x = \int\cos(bx)\, \mathrm{d}x + \int\cos^2(ax)\cos(bx)\, \mathrm{d}x = \int\cos^2(ax)\cos(bx)\, \mathrm{d}x.
$$

$$
a = b: \int\cos^3(ax)\, \mathrm{d}x \ne 0;\\
a \ne b: \int\cos^2(ax)\cos(bx)\, \mathrm{d}x = 0.
$$




$$
U_t = \Delta T \cdot k \cdot S  = R\cdot F = \Delta T \cdot k \cdot V \cdot t.
$$
