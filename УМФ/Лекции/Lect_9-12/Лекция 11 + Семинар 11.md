Ред. Кудреватых Павел, ПМ-31.

## Лекция 11

Тема: Интегральные преобразования Лапласа и Фурье.

#### Для чего нужны интегральные преобразования?

1. Решать ДУЧП;
2. Вычислять характеристики физических объектов и систем;
3. Обрабатывать изображения.

Иллюстрация решения выражения посредством преобразования Фурье:

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/2880px-Commutative_diagram_illustrating_problem_solving_via_the_Fourier_transform.svg)

Ссылки для ознакомления с материалом: 

https://foxford.ru/wiki/fizika/kolebatelnyy-kontur

https://www.youtube.com/watch?v=spUNpyF58BY

https://www.youtube.com/watch?v=n2y7n6jw5d0



_________________



#### Что такое интегральные преобразования?

С точки зрения предельного перехода, интегральное преобразование — разложение по счетному (бесконечное количество $n \in \N$) базису функций; это вектор "координат" в базисе:
$$
f(x) = \sum_i F_i\sin \left(\frac \pi l i x\right); \\
F_i = \int\limits_{0}^{l} f(x) \sin\left(\frac \pi l i x\right)\, \mathrm{d}x, \;\;\; i \in \N.
$$
Получается, что в базисе синусов, например, мы можем записать вектор координат $F = [F_1, F_2,...,F_n]$.  При предельном переходе можно сказать, что перед нами функция $F(w) = F_w$.

Вектор $F(w)$ координат функции в функциональном базисе называется **спектром функции**. Если это дискретный случай, то говорят о **дискретном спектре**, если это непрерывный случай — говорят о **непрерывном спектре**. Кроме этого, спектр может быть ограниченным (от 0 до $l$) или неограниченным (на всей числовой прямой). Каким именно является спектр обычно становится понятно из контекста. Гораздо важнее информация о том, какой именно использовался базис. Поэтому чаще в обиходе говорят о **cпектре Фурье** или **cпектре Лапласа**.

С точки зрения функциональных пространств, интегральное преобразование — это функция $F(w)$, которая в каждой точке $w$ принимает значение — результата интегрирования исходной функции с базисной функцией. Используя формулы выше, запишем:
$$
\mathcal{F} (f)= F(\omega)= \int\limits_{-\infty}^{\infty}f(x)e^{\displaystyle-2\pi i \omega x}\, \mathrm{d}x;\\
\Phi = \mathcal{F}^{-1} (F) =f(x) = \int\limits_{-\infty}^{\infty}F(x)e^{\displaystyle2\pi i \omega x}\, \mathrm{d}x.\\
$$
Обратите особое внимание, что степень экспоненты есть ничто иное, как **масштабирующий коэффициент**. Поэтому, если рассматривать качественные, а не количественные графики, можно записать для Фурье и для Лапласа следующее:

$$
\mathcal{F}(f)= F(\omega) = \int f(x)e^{\displaystyle-i\omega x} \, \mathrm{d}x; 
\\
\mathcal{L} = F(s) = \int f(x)e^{\displaystyle(a-ib) x} \, \mathrm{d}x , \quad s = a-ib.
$$
Если в преобразовании Лапласа $a = 0$, то получается преобразование Фурье.

#### Образ Фурье различных функций

Кратко повторим основные моменты стандартной таблицы преобразований Фурье:

|                        Функция                         |                         Образ                          |
| :----------------------------------------------------: | :----------------------------------------------------: |
|                      $\delta(x)$                       |                          $1$                           |
|               $\alpha f(x) + \beta g(x)$               |               $\alpha F(w) + \beta G(w)$               |
|                        $f(x-a)$                        |              $e^{\displaystyle-iwa}F(w)$               |
|          $\displaystyle\frac {d^nf(x)}{dx^n}$          |                     $(iw)^n F(w)$                      |
| $f(x) * g(x) = \int f(x-\tau)g(\tau)\, \mathrm{d}\tau$ |                       $F(w)G(w)$                       |
|             $f(x) = П(x) $- прямоугольник              | $F(w) = \displaystyle\frac{\sin(w)}{w}$ - или **SINC** |



Обратите особое внимание, что указаны только прямые преобразования. Если посмотреть на стандартные формулы прямого и обратного преобразования Фурье, то заметим, что они одинаковые.

**Это значит**:

* Запрограммировать нужно будет только одно преобразование Фурье;
* Все свойства обратимы. Если встретилась сложная операция в действительной области, то переходим в частотную. Если встретилась в частотной — в действительную.

**Проиллюстрируем**:

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/Fourier-transform-of-a-rectangle-function-a-and-a-sinc-function-b.png)

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/P84.gif)



SINC возникает всегда, когда у нас есть ограничение по времени. Особенно это актуально в любом электричестве: переменный ток течет только синусоидами, любая сеть имеет хоть сколько-нибудь значимый колебательный LC-контур. Выходит, что при включении (подаче питания) никогда не будет прямоугольного импульса, всегда будет SINC.

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/kisspng-spectral-leakage-fourier-transform-thumbnail-5b08d5e5b61384.2117087015273057017458.svg)





#### Почему Фурье лучше, чем Лаплас и другие?

Дело в том, что преобразование Фурье, а именно разложение на синусы и косинусы, появляется в очень многих физических задачах:

1. **Решение любых колебательных физических проблем** (пружина, распространение тепла):
   1. Из 4 фундаментальных сил, две (сильная и слабая) существуют внутри ядра и в повседневной жизни не встречаются;
   2. Две других (гравитация и электромагнетизм) решаются при помощи Фурье. 
   
2. **Решение задач оптики** и распространения света, дифракции и интерференции.

Любая линза, призма или дифракционная щель — ничто иное, как физическое приложение преобразования Фурье. Например, когда появляется радуга, мы видим разложение нашего света на спектр (синусоиды). Если светить лазером на маленькую щель, мы увидим на стене интерференцию, то есть функцию **SINC** от прямоугольной функции — интенсивности лазера. 

**По мощности:**

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/QgaKI.svg)

**Исходная функция:**

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/1280px-Mplwp_sinc.svg.png)

**Интерференция:**

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/i)

**Вид:**

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/38.png)

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/1200px-MichelsonParalleleLampeMercure.JPG)



> Нетрудно показать, что, меняя ширину прямоугольника (ширину щели), мы можем поменять интерференционную картину, сузив расстояние между дифракционными максимумами.

3. **Решение задач электросхем** (токи внутри микрочипов и микропроцессоров).

   Любая задача с электросхемой — совокупность прямоугольных цифровых импульсов и LC-колебательных контуров. Особое применение этих вычислений нашлось у проектировщиков печатных плат, когда они пытаются на параллельных линиях, например, PCI-E, посчитать все индуктивности длины дорожек. Именно поэтому "удлинители" высокочастотных шин очень редки, так как их расчет и изготовление — муторный и не дающий гарантий процесс. Все линии должны быть разведены внутри твердой и негнущейся материнской платы.

   ![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/memory-1761599_1280.jpg)

<img src="%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/image-20201123172309289.png" alt="image-20201123172309289" style="zoom: 25%;" />

$I = I(t)$ - сила тока в контуре,

$q = q(t)$ - заряд конденсатора,

$U_C = U_C(t)$ - напряжение на конденсаторе,

$U_L = U_L(t)$ - напряжение на катушке индективности.



Каждая из основных величин будет изменяться по закону синуса или косинуса с циклической (собственной) частотой.
$$
\omega = \frac{1}{\sqrt{LC}}.
$$

| Сила тока $I$ в контуре | Заряд $q$ конденсатора | Напряжение $U_C$ на конденсаторе | Напряжение $U_L$ на катушке |
|:---:|:---:|-----|-----|
| $I = I_0 \cdot \sin(\omega\cdot t)$ | $q = q_0 \cdot \cos(\omega \cdot t)$ | $U_C = U_0 \cdot \cos(\omega \cdot t)$ | $U_L = U_0 \cdot \cos(\omega \cdot t)$ |

Доказательство:

   1. Первоначальный заряд конденсатора равен $q_0 = CU_0$. Сразу после замыкания ключа $K$ ток в цепи не изменится скачком и будет нулевым. Это связано с наличием катушки индуктивности, в которой изменению тока воспрепятствует ЭДС самоиндукции $\varepsilon_{si}$.

   2. Напряжение $U_C$ на конденсаторе прямо пропорционально его заряду $q$, то есть
      $$
      U_C = \frac{q}{C}.
      $$

   3. Напряжение $U_L$ на катушке определяется ее ЭДС самоиндукции $\varepsilon_{si}$ по формуле

$$
   U_L = -\varepsilon_{si} = L \cdot I'(t),
$$

   ​		где $I'(t) = \displaystyle\frac{\Delta I}{\Delta t}$ — скорость изменения тока $I$ (производная тока).

   4) Электрический ток в контуре обусловлен перетеканием заряда с одной обкладки конденсатора на другую, поэтому

$$
I = -q'(t),
$$

   ​		где $q'(t) = \displaystyle\frac{\Delta q}{\Delta t}$ — скорость изменения заряда $q$ конденсатора (производная заряда).

   5. Получается, что
$$
     U_L = -L \cdot q''(t),
$$
   где $q''(t) = -I'(t)$ — вторая производная заряда $q$ конденсатора.

   6. Выводы конденсатора и катушки накоротко замкнуты друг на друга, поэтому напряжения на них равны. Выходит, что
      $$
      U_c = U_L.
      $$

   7) Последнее соотношение преобразовывается путем подстановки выражений для напряжений $U_C$ и $U_L$. Получается дифференциальное уравнение гармонических колебаний, что

$$
   q''(t) + \omega^2 \cdot q(t) = 0,
$$

   где число $\omega = \displaystyle\frac{1}{\sqrt{LC}}$ называется циклической (собственной частотой колебаний).



### Итог

Существуют специализированные базисы, которые лучше работают в частных случаях, но Фурье применяется повсеместно. "*One Fourier to rule them all*".

* Лаплас лучше всего работает в задачах с колебательными процессами (пружины, маятники, волны на воде);
* С цифровыми изображениями (квадратные пиксели) лучше всего работает базис из прямоугольных функций — Вейвлет-преобразования;
* Для полиномиальных проблем существуют Полиномы Лежандра, Функции Бесселя и прочие.

Другая причина, почему Фурье применяется повсеместно, состоит в том, что существуют высоко оптимизированные библиотеки, например, FFTW, которые применяют быстрое преобразование со сложностью $O(n\log(n))$ или лучше. Вейвлеты, Бессели и Лаплас имеют сложность $O(n^2)$. Результат на практике может быть и не идеален, но разницы "на глаз" будет не заметно. Надо учитывать, что все эти способы — приближенные решения, так как никто не сможет "просуммировать бесконечное количество синусов". Если же на практике нет разницы, то зачем платить больше и использовать более сложные и ресурсоемкие операции, когда Фурье в виде БПФ (Быстрого Преобразования Фурье) беспроигрышный вариант?

![Fourier](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/fourier.jpg)



## Семинар 11

Тема: Применение интегральных преобразований Фурье и Лапласа.



#### Где Лаплас?

Интегральное преобразование Лаплас - это расширение над интегральным преобразованием Фурье. Вспомним их формулы:
$$
\mathcal{F}(f)= F(\omega) = \int f(x)e^{\displaystyle-i\omega x} \, \mathrm{d}x;
\\
\mathcal{L} = F(s) = \int f(x)e^{\displaystyle(a-ib) x} \, \mathrm{d}x , \quad s = a-ib.
$$
И действительно, отличие только в экспоненте. Лаплас рассматривает не пространство обычных синусов, а пространство синусов, спадающих по экспоненте (затухающие колебания). Именно поэтому Лаплас идеально подходит для вычисления любых задач с потерей энергии.

Рассмотрим пример с грузом массой 1 кг на пружине.

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/maxresdefault.svg)



Можем записать, что движение такого груза будет описано ОДУ:
$$
ma = F_{тяж} - kx - bV.
$$
Прочитать это уравнение можно так: суммарная сила, действующая на груз, равна сумме силы тяжести, силы упругости со знаком минус, силы сопротивления воздуха (или другого сопротивления) со знаком минус.

Результатом будут затухающие колебания. Переведем уравнение в ОДУ:
$$
m\ddot{x} = -kx -b\dot{x} + F.
$$
Перенесем в левую часть все, кроме констант:
$$
m\ddot{x}+ b\dot{x} + kx  = F.
$$
Возьмем преобразование Лапласа, воспользовавшись основным свойством интегральных преобразований:
$$
f(x) \implies F(s);\\
f'(x) \implies sF(s);\\
f''(x) \implies s^2F(s).\\
$$

$$
\mathcal{L}(m\ddot{x}+ b\dot{x} + kx) = \mathcal{L}(F).
$$

Не забываем, что сила в нашем случае константа и примерно равна $10m$ Н (1 кгс):
$$
\mathcal{L}(x(t))(ms^2+ bs + k) = \frac{10m}{s};\\
X(s) = \frac{10m}{s(ms^2+ bs + k)}.
$$
Теперь можно применить обратное преобразование и получить траекторию маятника $x(t)$, но сначала обратим внимание, что у нас есть несколько особых точек — точек, в которых знаменатель превращается в ноль, — **полюса** функции.
$$
\begin{matrix}

m = 1,\ k = 1,\ b = 0;
&\quad
m = 1,\ k = 10,\ b = 2;

\\

\begin{cases}
s = 0;\\
s = +i;\\
s = -i; 
\end{cases}

&\quad

\begin{cases}
s = 0;\\
s = -1+3i;\\
s = -1-3i. 
\end{cases}

\end{matrix}
$$
Таким образом, первое и второе решения на графиках:

> Внимание! Положение по оси ОХ означает степень экспоненты, а положение по оси ОУ — частоту колебаний.

<img src="%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/image-20201123191716737.png" alt="image-20201123191716737" style="zoom:33%;" />



<img src="%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2011%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2011.assets/image-20201123191753773.png" alt="image-20201123191753773" style="zoom: 33%;" />



Запишем численное решение, взяв обратное преобразование Лапласа:
$$
\begin{matrix}

m = 1,\ k = 1,\ b = 0;
&
m = 1,\ k = 10,\ b = 2;

\\

\mathcal{L^{-1}} \left(
\displaystyle\frac{10}{s(s^2+1)}
\right)
=
10(1-cos(t));

&\quad

\mathcal{L^{-1}} \left(
\displaystyle \frac{10}{s(s^2+2s+10)}
\right)
=
1 - \frac 1 3 e^{-t}
\left(
\sin(3t) + 3 \cos(3t)
\right).

\end{matrix}
$$
**Таким образом, изучая график преобразования Лапласа, можно сразу понять ответ.** Исходя из этого, достаточно просто регулировать линейные параметры системы и двигать график туда, куда нужно. Если необходимо, чтобы колебание было чаще, то сдвигаем полюс и смотрим на нужные характеристики упругости (сопротивления воздуха) и жесткости пружины.





#### Как применять Интегральные Преобразования к ДУЧП

**Важно!!** При решении ДУЧП нужно понимать, что интегрирование по x от $-\infty $ до $\infty$ вполне применимо, а вот при интегрировании по времени нет (время должно начинаться от нуля). Таким образом, мы не можем предполагать нулевых НУ и должны их учитывать.

**Важно!!** Применительно к ДУЧП, интегральное преобразование Фурье является частным случаем Лапласа, поэтому отдельно рассматривать его нет смысла (полюсы получатся без действительной части как в примере выше).

При взятии производных не забываем:
$$
\begin{array}{l|l}
f'(t)\quad &\quad sF(s) - f(0^-);\\
f''(t) & \quad s^2F(s) - sf(0^-) - f'(0^-).
\end{array}
$$


####  Пример (8.13 из учебника):

Решить КЗ:
$$
U_{tt} = 4 U_{xx};\\
U(0,t) = t^2, U_x(0,t) = -t; \\
U(x,0) = 0, U_t (x,0) = 0.
$$
Первым делом сделаем преобразование Лапласа. Так как мы не умеем делать ПЛ по двум координатам синхронно, то сделаем его по очереди. Сначала запишем его по x. Обратите внимание, что по условиям задачи $x>0$. Из-за этого с учетом НУ формулы придется применить и для X, и для T.

Пусть $ U(x,t)\implies U(p,t)$.
$$
U_{tt}(x,t) = U_{tt}(p,t);\\
4U_{xx}(x,t) = 4p^2U(p,t) - 4pt^2 + 4t;\\
U(x,0) = U(p,0) = 0;\\
U_t(x,0) = U_t(p,0) = 0.
$$
 Запишем тоже самое, но по t. Пусть $ U(p,t)\implies U(p,q)$.
$$
U_{tt}(p,t) = q^2U(p,q) - q*0 - 0;\\
 4p^2U(p,t) - 4pt^2 + 4t =  4p^2U(p,q) - 8\frac{p}{q^3}  + \frac{4}{q^2}.\\
$$
Основное равенство: 
$$
q^2U(p,q) = 4p^2U(p,q) - 8\frac{p}{q^3}  + \frac{4}{q^2};\\
U\cdot(q^2 - 4p^2) = \frac{4}{q^2} - \frac{8p}{q^3};
$$

$$
U(q^2 - 4p^2) =\frac{4(q-2p)}{q^3} \\
\frac{4(q-2p)}{q^3(q^2 - 4p^2)}= \frac{4}{q^3(q + 2p)} = U.
$$

Получим развертку во временную область из частотной.  $q \implies t$ и $p \implies x$ в удобной для нас последовательности. Воспользуемся свойствами:
$$
\begin{array}{l|l}
\textsf{экспоненциальное затухание}\quad &\quad e^{-\displaystyle\alpha t} \cdot H(t)\quad &\quad \displaystyle\frac{1}{s + \alpha}\\
\textsf{степенная n-го порядка} &\quad \displaystyle\frac{t^n}{n!} \cdot H(t) &\quad \displaystyle\frac{1}{s^{n+1}}
\end{array}
$$

$$
\frac{4}{q^3(q + 2p)} = \frac{2}{q^3(0.5q + p)} \implies \frac{4}{2q^3} e^{\displaystyle-0.5qx}.
$$
Выше записана развертка в X. Повторяем процедуру, используя следующие свойства:
$$
\begin{array}{l|l}
\textsf{запаздывание n-го порядка с частотным сдвигом}\quad &\quad \displaystyle\frac{(t-\tau)^n}{n!}e^{-\displaystyle\alpha(t-\tau)} \cdot H(t-\tau)\quad &\quad\displaystyle\frac{e^{\displaystyle-\tau s}}{(s + \alpha)^{n + 1}}
\end{array}
$$

$$
\frac{2}{q^3} e^{\displaystyle-0.5qx} \implies 2 \left(
\frac{(t - (0.5x))^2}{2!}H(t - 0.5x) 
\right)
=

(t - (0.5x))^2H(t - 0.5x).
$$

**Запишем ответ**:
$$
U(x,t) = \left(t-\frac x 2\right)^2,\\
x\leq 2t.
$$
