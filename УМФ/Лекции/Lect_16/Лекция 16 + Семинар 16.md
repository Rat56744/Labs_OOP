## Лекция 16

Тема: Криволинейные координаты, основные дифференциальные операторы в криволинейных координатах. Полярные, цилиндрические координаты вращения и сферические координаты, оператор Лапласа в этих координатах

Можно подробнее почитать в очень хорошем учебнике: "Методы теоретической физики, Том 1, Морс Ф.М., Фешбах Г., 1958."

_________



Небольшое путешествие в очень важное развитие ДУЧП на фигуры произвольной формы. До сих пор мы рассматривали одномерные случаи и несмотря на то, что в учебнике были изложены базовые подходы к 2-мерным и 3-мерным случаям, все они рассматривали элементарные частицы поверхности или объема.

Самый сложный вариант, который был до этого (ввиду своей уникальности) - это колебания тонкой **круглой** мембраны и потенциал электрического заряда в объеме.

Однако, инженеры требовали решений уже "сегодня", с текущим уровнем техники, а ученые понимали, что аналитически вывести формулу для тела произвольной формы практически невозможно (и даже если это возможно, при изменении формы поменяется и решение).

К счастью, был применен старый подход сведения сложной задачи к уже решенной путем одного из мощнейших инструментов в руках прикладной математики - замене системы координат.

С самых старых времен, мы сами того не зная, решали задачи в удобной нам системе координат (например движение по плоскости и поиск кратчайшего пути из города в город), хотя поверхность Земли очень далека от плоскости при любом масштабе рассмотрения и вообще имеет форму Геоида. 

Такой же подход имеет место и для вычислений в конечно-разностных схемах. Решая задачу для одномерного случая или плоскости, вполне возможно "изогнуть" эту плоскость удобным нам образом, превращая решение на плоскости в решение на произвольной поверхности.



Тут нам на помощь спешит дифференциальная геометрия и топология, основная задача которых - ответить на вопрос: "А до какой степени можно "рвать" и мять плоскую поверхность так, чтобы наше решение продолжало оставаться правильным?" Очевидно, есть какой-то предел. Не углубляясь вперед в эти сложные предметы, мы можем оттуда позаимствовать главные выводы (ниже приведены и они означают **одно и то же**)

*  С точки зрения топологии - наше преобразование плоскости должно быть непрерывным и гладким.
* С точки дифференциальной геометрии - наше преобразование должно быть описано аналитической функцией.



### Часть 1. Криволинейные координаты, циллиндрическая и сферическая координаты

Давайте вспомним две самых понятных и самых простых системы координат которые вы знаете

##### Цилиндрическая система координат

<img src="%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/2560px-Cylindrical_with_grid.svg.png" alt="img" style="zoom: 25%;" />

Уравнения для изменения системы координат
$$
\begin{cases}
\rho=\sqrt{x^2+y^2}, \\
\varphi=\mathrm{arctg}\left(\dfrac{y}{x}\right), \\
z=z.
\end{cases}
\iff 
\begin{cases}
x=\rho\cos\varphi, \\
y=\rho\sin\varphi, \\
z=z.
\end{cases}
$$




##### Сферическая система координат

Сферическая система координат оперирует одной координатой длины и двумя координатами углов

<img src="%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/2560px-Spherical_with_grid.svg.png" alt="img" style="zoom:25%;" />
$$
\begin{cases}
x=r\sin\theta\cos\varphi, \\
y=r\sin\theta\sin\varphi, \\
z=r\cos\theta.
\end{cases} 
\iff
\begin{cases}
r=\sqrt{x^2+y^2+z^2}, \\
\theta=\arccos\dfrac{z}{\sqrt{x^2+y^2+z^2}}=\mathrm{arctg}\dfrac{\sqrt{x^2+y^2}}{z}, \\
\varphi=\mathrm{arctg}\dfrac{y}{x}.
\end{cases}
$$


#### Направляющие косинусы

Теперь давайте разберемся с основным определением. Что же такое система координат (давайте сразу говорить про ортогональную систему координат чтобы не усложнять себе жизнь, кроме этого мы сразу договоримся, что речь идет про трехмерное эвклидово пространство - функциональные базисы и произвольные векторные пространства за кармой)? 

Попробуйте сами ответить на данный вопрос. Многие могут ограничиться тем, что скажут, что если мы говорим про самое обычное трехмерное пространство вокруг нас, то ответ прост. Система координат - это правило, по которому любой точке пространства мы присваиваем уникальные координаты ("номер"). Размерность пространства - это необходимое количество координат, чтобы пронумеровать все точки.

Есть одно "но" в таком подходе. Для того, чтобы пронумеровать ВСЕ точки самого обычного трехмерного пространства, достаточно ОДНОГО числа. Значит ли, что это пространство неожиданно стало одномерным? Правильный ответ - нет. Кроме этого, нам надо понимать, по какому именно закону мы будем нумеровать наши точки. Отсюда уже следует более "продвинутое" определение системы координат: это алгоритм присвоения любой точке пространства порядкового номера. 

*  Для декартовой системы координат мы выбираем начальную точку, проводим три перпендикулярных оси, проводим радиус вектор к точке, ищем его проекции.
* Для цилиндрической системы координат мы выбираем начальную ось и измеряем расстояние и угол.



А теперь второй вопрос - допустим, вы построили систему координат, но как мне, стоя в другом конце аудитории с вами договориться о том, какие лично у меня и у моих точек будут координаты? Тут приходит на помощь **клиент-серверный подход** **"Направляющие косинусы"**.

Почему это важно? Потому что компьютер, когда делает вычисления, каждая итерация, каждый маленький процесс на многоядерной системе обрабатывает свой локальный кусочек пространства. Да и вы сами, когда работаете с другими инженерами, хотите иметь какой-то способ сверить ваши системы координат.

Название, конечно, ненастоящее, но неплохо объясняет суть. Я уже что-то делаю в своей произвольно выбранной системе координат (декартовой). И тут мне надо сообщить вам координаты объекта (линии, фигуры, решения) в вашу систему координат.

Я у вас спрашиваю "дай мне систему координат для моей системы координат". Вы мне даете:

* Радиус-вектор смещения центра координат
* Направляющие косинусы (углы между моей осью Z и вашей осью Z).

Вы как будто берете вашу систему и отправляете ее мне. Вы - сервер раздающий координаты, а я выступаю клиентом.

И тут может произойти неприятное - оказывается, что прямая линия в вашей системе координат (например системе координат г. Москвы) в моей системе координат (пл. Земля) не является прямой, а является кривой. Это неприятная неожиданность.

![image-20201229175301450](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/image-20201229175301459.png)

Таким образом мы видим, что несмотря на то, что система координат локально ортогональна, она в целом двигается по криволинейной траектории.

Дополненное определение криволинейной системы координат:

Криволинейная **ортогональная и нормированная** система координат в пространстве $\R^3$ это система координат обладающая следующими свойствами:

1. Существует некоторая **референсная** система координат построенная ортами $\vec i, \vec j, \vec k$ ("прямолинейная", ведь наша система координат должна быть **криволинейной по сравнению с чем-то**?)
2. В каждой точке пространства существует ортогональная система координат из Ортов $\vec e_1, \vec e_2, \vec e_3$.
3. Ориентация Ортов $\vec e_1, \vec e_2, \vec e_3$ относительно ортов $\vec i, \vec j, \vec k$ определяется углами поворота относительно осей $x,y,z$ именно в таком порядке $\alpha, \beta, \gamma$. Эти углы называются **Углами Эйлера**
4. При этом для каждого из векторов $\vec e_1, \vec e_2, \vec e_3$ существуют их координаты в старой системе координат, именно они и называются **направляющими косинусами**

$$
\begin{cases}
\vec e_1 = \cos (\alpha_1)\vec i + \cos (\beta_1)\vec j+ \cos (\gamma_1)\vec k\\
\vec e_2 = \cos (\alpha_2)\vec i + \cos (\beta_2)\vec j+ \cos (\gamma_2)\vec k\\
\vec e_3 = \cos (\alpha_3)\vec i + \cos (\beta_3)\vec j+ \cos (\gamma_3)\vec k
\end{cases}
$$

Из рисунка на плоскости выше нетрудно видеть, что эти углы будут меняться в каждой точке, т.е. они являются непрерывными функциями от ортогональных координат.

5. Координаты ортов $\vec e_1, \vec e_2, \vec e_3$ - это направляющие косинусы от углов, которые меняются в виде непрерывных функций от точки в пространстве, так что можно заключить, что сами орты $\vec e_1, \vec e_2, \vec e_3$ являются непрерывными функциями, описывающими новую систему координат:
   $$
   A = x \vec i + y \vec j + z \vec k =\xi_1(x,y,z)\vec e_1 + \xi_2(x,y,z)\vec e_2 + \xi_3(x,y,z)\vec e_3\\
   $$
   



Направляющие косинусы новой системы координат определяются, как уже говорилось, углами поворота. Эти углы поворота называются **Углами Эйлера**

![img](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/Euler2a.gif)

> **Бонус**! Вы наверное уже знаете, но вращения тела по углам Эйлера образуют группу симметрий сферы с точки зрения общей алгебры!  А это значит, что все операции в этой группе линейные и могут быть выражены через матрицу линейного оператора. В Википедии и других источниках вполне можно найти законы построения матриц перехода и вращения по углам Эйлера, а вам нетрудно будет проверить (или поверить), что все эти матрицы являются линейными операторами в группе.

### Часть 2. Произвольные криволинейные системы координат (Ортогональные). 

Для начала - шокирующий факт. **Любая аналитическая функция может быть основой для криволинейной системы координат**. Например, на плоскости перед нами на примере снизу параболическая система координат.  Обратите внимание, что все линии "осей" (обе оси изогнуты параболой и смотрят друг на друга) перпендикулярны друг другу в любой точке плоскости. А перед нами простейшая система координат второго порядка. 



![image-20201228232107372](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/image-20201228232107372.png)

#### Проблема

Как видно на рисунке выше, наши линии осей расходящиеся! В принципе в этом нет ничего страшного, только есть одно противоречие:

* В референсной системе координат квадрат размером 1 х 1 или $dx\times  dy$ имеет одинаковую площадь независимо от того, куда мы его передвинули. В то же время, в новой системе координат он меняется и искажается. Причем в зависимости от того, куда и как он был сдвинут, наш квадрат может оказаться вовсе не квадратом (прямоугольником или произвольной кривой фигурой).
* В референсной системе координат приращение вдоль линии пути всегда пропорционально $dx $ или $dy$, и у нас никогда не возникает проблем с тем, что каждый раз одинаковые шаги по координатам могут существенно повлиять на длину пройденного пути. А вот если мы двигаемся вдоль графика кривой - несмотря на одинаковые шаги $dx$, приращение $dy$ будет сильно зависеть от производной в этой точке.

Для того чтобы бороться с этой проблемой нам нужно в каждой точке нашей системе присвоить два вида коэффициентов:

* Коэффициент элементарного объема - **Якобиан перехода**
* Коэффициент растяжения осей - **Коэффициенты Ламе**

#### Якобиан перехода (повторение!)

Якобиан перехода является коэффициентом пропорциональности между элементарным объемом ДО и ПОСЛЕ изменения системы координат: 
$$
dV = dxdydz = Jd\xi_1d\xi_2d\xi_3
$$
Для полярной системы координат на плоскости:
$$
J(r,\varphi) = \det \hat{I}(r,\varphi) =\det \begin{bmatrix}
	\cos\varphi & -r\, \sin\varphi \\
	\sin\varphi &  r\, \cos\varphi 
\end{bmatrix} = r.
$$
Для сферической системы координат:
$$
J(r,\theta,\varphi) = \det \hat{I}(r,\theta,\varphi) =\det \begin{bmatrix}
	\sin\theta\, \cos\varphi &  r\, \cos\theta\, \cos\varphi  & -r\, \sin\theta\, \sin\varphi \\
	\sin\theta\, \sin\varphi &  r\, \cos\theta\, \sin\varphi  &  r\, \sin\theta\, \cos\varphi \\
	\cos\theta            &  -r\, \sin\theta            &             0
\end{bmatrix} = r^2 \sin\theta.
$$




#### Коэффициент Ламе

Давайте запишем уравнение для длины элементарного очень маленького вектора $\vec s = \{dx,dy,dz\}$ в декартовой системе координат:
$$
ds^2 = dx^2 + dy^2 + dz^2\\
\begin{cases}
x = \phi_1(\xi_1,\xi_2,\xi_3)\\
y = \phi_2(\xi_1,\xi_2,\xi_3)\\
z = \phi_3(\xi_1,\xi_2,\xi_3)\\
\end{cases}
$$
Тогда пользуясь правилом сложной производной можно записать:
$$
ds^2 = \left( \frac{\partial \phi_1}{\partial \xi_1}d\xi_1 \right)^2
+ \left( \frac{\partial \phi_2}{\partial \xi_1}d\xi_1 \right)^2
+ \left( \frac{\partial \phi_3}{\partial \xi_1}d\xi_1 \right)^2 \\
+\left( \frac{\partial \phi_1}{\partial \xi_2}d\xi_2 \right)^2
+ \left( \frac{\partial \phi_2}{\partial \xi_2}d\xi_2 \right)^2
+ \left( \frac{\partial \phi_3}{\partial \xi_2}d\xi_2 \right)^2 \\
\left( \frac{\partial \phi_1}{\partial \xi_3}d\xi_3 \right)^2
+ \left( \frac{\partial \phi_2}{\partial \xi_3}d\xi_3 \right)^2
+ \left( \frac{\partial \phi_3}{\partial \xi_3}d\xi_3 \right)^2 \\
$$
Первая тройка отвечает за X, вторая за Y и третья за Z.

Можно совсем немного переписать:
$$
ds^2 = h_1^2 d\xi_1^2 + h_2^2 d\xi_2^2 +h_3^2 d\xi_3^2 
$$
где
$$
h_i = \sqrt{\left( \frac{\partial \phi_1}{\partial \xi_i} \right)^2
+ \left( \frac{\partial \phi_2}{\partial \xi_i} \right)^2
+ \left( \frac{\partial \phi_3}{\partial \xi_i} \right)^2}
$$
Перед нами - коэффициенты Ламе или масштабирующие коэффициенты

> В зарубежной литературе они обозначаются  $H_i$, в отечественной $h_i$, оба обозначения равнозначны.

<img src="%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/image-20201229192406107.png" alt="image-20201229192406107" style="zoom:100%;" />

##### Цилиндрическая система координат

<img src="%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/2560px-Cylindrical_with_grid.svg.png" alt="img" style="zoom: 25%;" />

Уравнения для изменения системы координат:
$$
\begin{cases}
\rho=\sqrt{x^2+y^2}, \\
\varphi=\mathrm{arctg}\left(\dfrac{y}{x}\right), \\
z=z.
\end{cases}
\iff 
\begin{cases}
x=\rho\cos\varphi, \\
y=\rho\sin\varphi, \\
z=z.
\end{cases}
$$
Коэффициенты Ламе:
$$
h_\rho = 1\\
h_\varphi = \rho\\
h_z = 1
$$
Оператор Лапласа:
$$
\Delta f 
= {1 \over r} {\partial \over \partial r}
  \left( r {\partial f \over \partial r} \right) 
+ {\partial^2f \over \partial z^2}
+ {1 \over r^2} {\partial^2 f \over \partial \varphi^2}
$$




##### Сферическая система координат

Сферическая система координат оперирует одной координатой длины и двумя координатами углов:

<img src="%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/2560px-Spherical_with_grid.svg.png" alt="img" style="zoom:25%;" />
$$
\begin{cases}
x=r\sin\theta\cos\varphi, \\
y=r\sin\theta\sin\varphi, \\
z=r\cos\theta.
\end{cases} 
\iff
\begin{cases}
r=\sqrt{x^2+y^2+z^2}, \\
\theta=\arccos\dfrac{z}{\sqrt{x^2+y^2+z^2}}=\mathrm{arctg}\dfrac{\sqrt{x^2+y^2}}{z}, \\
\varphi=\mathrm{arctg}\dfrac{y}{x}.
\end{cases}
$$
Коэффициенты Ламе:
$$
h_\rho = 1\\
h_\varphi = \rho \sin(\theta)\\
h_\theta= \rho
$$
Оператор Лапласа:
$$
\Delta f 
= {1 \over r^2} {\partial \over \partial r}
  \left( r^2 {\partial f \over \partial r} \right) 
+ {1 \over r^2 \sin \theta} {\partial \over \partial \theta}
  \left( \sin \theta {\partial f \over \partial \theta} \right) 
+ {1 \over r^2\sin^2 \theta} {\partial^2 f \over \partial \varphi^2}
$$

**Связь Якобиана и Коэффициентов Ламе:**  
$$
J = h_1 h_2 h_3
$$


> Для доп.изучения: Вращение криволинейных координат, элемент объема криволинейных координат, Сферические координаты (мы будем изучать только циллиндрические)



### Часть 3. Разделяющие координаты в различных системах

У нас чаще всего возникают уравнения, включающие в себя  оператор Лапласа $\Delta = \frac {\partial^2}{\partial x^2} + \frac {\partial^2}{\partial y^2} + \frac {\partial^2}{\partial z^2}$ 

Как он выглядит в различных системах координат? Для трех координат имеет следующий вид:
$$
\Delta f= \sum_i \frac{1}{h_1h_2h_3}\frac{\partial}{\partial\xi_i^2}\left[\frac{h_1h_2h_3}{h_i^2} \frac{\partial f}{\partial\xi_i^2}\right]
$$


Или можно переписать через Якоби:
$$
\Delta f= \sum_i \frac{1}{J}\frac{\partial}{\partial\xi_i^2}\left[\frac{J}{h_i^2} \frac{\partial f}{\partial\xi_i^2}\right]
$$
Из этой формулы нетрудно вывести (подтвердить) формулы для полярной и сферической систем. А что насчет систем других видов? Ведь аналитическими функциями могут быть любые функции.

##### Пример 1. Круговые цилиндрические координаты  (Одна ось - прямая, вторая - эллипс, третья - гипербола)

<img src="%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/2560px-Elliptical_coordinates_grid.svg.png" alt="img" style="zoom:25%;" />



Основные координаты:
$$
\begin{cases}
x = \xi_1\xi_2\\
y = \sqrt{(\xi_1^2 - d^2)(1-\xi_2^2)}\\
z = \xi_3
\end{cases}
\iff
\begin{cases}
\xi_1 = d \,\mathrm{ch} \mu = \frac 1 2(r_1+r_2)\\
\xi_2 = \cos \varphi = \frac{1}{2d}(r_1-r_2)\\
\xi_3 = z
\end{cases}
$$
Тогда нетрудно найти коэффициенты Ламе:
$$
h_1 = \sqrt{(\xi_1^2 - d^2\xi_2^2)(\xi_1^2-d^2)}\\
h_2 =  \sqrt{(\xi_1^2 - d^2\xi_2^2)(1-\xi_2^2)}\\
h_3 = 1
$$
И оператор Лапласа:
$$
\Delta f = \frac{1}{\xi_1^2 -\xi_2^2} \left[
\sqrt{\xi_1^2-1}\frac{\partial }{\partial \xi_1}
\left(
\sqrt{\xi_1^2-1}\frac{\partial f}{\partial \xi_1}
\right)
+
\sqrt{1-\xi_2^2}\frac{\partial }{\partial \xi_2}
\left(
\sqrt{1-\xi_2^2}\frac{\partial f}{\partial \xi_2}
\right)
\right]
+
\frac{\partial ^2 f}{\partial z^2}
$$


##### Пример 2. Параболические цилиндрические координаты (две оси параболы и одна прямая)

Рассмотрим квадратичную функцию, которую мы уже приводили выше, и продлим ее на третье измерение путем параллельного переноса.

![Parabolic coords.svg](%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%2016%20+%20%D0%A1%D0%B5%D0%BC%D0%B8%D0%BD%D0%B0%D1%80%2016.assets/2880px-Parabolic_coords.svg.png)

Основные координаты:
$$
\begin{cases}
x=\xi_1\xi_2\cos\varphi, \\
y=\xi_1\xi_2\sin\varphi, \\
z=\dfrac{1}{2}(\xi_2^2-\xi_1^2).
\end{cases}
\iff
\begin{cases}
\xi_1=-z+\sqrt{x^2+y^2+z^2}, \\
\xi_2=z+\sqrt{x^2+y^2+z^2}, \\
\xi_3 = \varphi=\mathrm{arctg}\dfrac{y}{x},
\end{cases}
$$
Тогда коэффициенты Ламе:
$$
h_1 = \sqrt{(\xi_1^2 + \xi_2^2)}\\
h_2 =  \sqrt{(\xi_1^2 + \xi_2^2)}\\
h_3 = \xi_1\xi_2
$$
И оператор Лапласа:
$$
\Delta f = \frac{1}{\xi_1^2 + \xi_2^2}
\left[
\frac{1}{\xi_1}
\frac{\partial}{\partial \xi_1}
\left(\xi_1
\frac{\partial f}{\partial \xi_1}
\right)
+
\frac{1}{\xi_2}
\frac{\partial}{\partial \xi_2}
\left( \xi_2
\frac{\partial f}{\partial \xi_2}
\right)
\right]
+
\frac{1}{\xi_1^2\xi_2^2}
\frac{\partial^2 f}{\partial \varphi^2}
$$








## Семинар 16





Задачи к контрольной:

КР-2

1. Решить методом Даламбера

$$
U_{tt} = 9U_{xx} + xе^2+6xt\\
U(0,x) = \cos(4x) \\
U_t(0,x) = \sin(x) + e^x
$$

2. Решить методом Грина

$$
U_t = 4U_{xx} + 9xt^2\\
U(0,x) = e^{x} + \cos(x)
$$

3. Решить методом Фурье

$$
U_{tt} = 4U_{xx} -3x\\
\begin{cases}
U(0,t) = 0\\
U_x(l,t) = 0\\
U(x,0) = 2\sin(\pi x/l)\\
U_t(x,0) = \sin (3 \pi x/2l)
\end{cases}
$$

4. Решить методом Фурье

$$
U_{t} = a^2U_{xx}\\
\begin{cases}
U_x(0,t) = 0\\
U_x(l,t) = 0\\
U(x,0) = 6 \cos(6\pi x/l)\\
U_t(x,0) =  \cos (\pi x/2l) -  \frac 1 3 \cos (2 \pi x/l) +\frac 1 7 \cos (8 \pi x/l)
\end{cases}
$$









